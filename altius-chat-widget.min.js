!(function () {
  const n = document.createElement('style');
  (n.textContent =
    "@keyframes pulse {\n  0%,\n  80%,\n  100% {\n    opacity: 0.3;\n    transform: scale(0.8);\n  }\n  40% {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n\n/* Main widget container */\n#chat-widget {\n  position: fixed;\n  bottom: 20px;\n  right: 20px;\n  z-index: 10000;\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n  width: 350px;\n  height: 570px;\n  pointer-events: none;\n}\n\n/* Chat button */\n#chat-button {\n  position: absolute;\n  right: 0;\n  bottom: 0;\n  width: 60px;\n  height: 60px;\n  background: #f44336;\n  border-radius: 50%;\n  cursor: pointer;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.3s ease;\n  z-index: 3;\n  border: none;\n  padding: 0;\n  pointer-events: auto;\n}\n\n#chat-button:hover {\n  transform: scale(1.05);\n}\n\n#chat-button:active {\n  transform: scale(0.95);\n}\n\n#chat-button svg {\n  display: block;\n}\n\n/* Chat window */\n#chat-window {\n  position: absolute;\n  right: 0;\n  bottom: 70px;\n  width: 350px;\n  height: 500px;\n  background: white;\n  border-radius: 16px;\n  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);\n  flex-direction: column;\n  overflow: hidden;\n  border: 1px solid #e1e8ed;\n  z-index: 2;\n  display: none;\n  pointer-events: auto;\n}\n\n/* Header */\n#chat-widget .header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  background: #19c6c2 !important;\n  color: #fff !important;\n  padding: 16px 18px 16px 18px !important;\n  border-radius: 16px 16px 0 0 !important;\n  min-height: unset;\n  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.04);\n  border-bottom: none;\n}\n\n#chat-widget .avatar {\n  margin-right: 12px;\n}\n\n#chat-widget .title {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n\n#chat-widget .title-text {\n  font-weight: 600;\n  font-size: 16px;\n  color: #222;\n  margin-bottom: 2px;\n  line-height: 1.2;\n}\n\n#chat-widget .bot-status {\n  display: flex;\n  align-items: center;\n  gap: 0;\n  font-size: 13px;\n  color: #e0f7fa;\n  margin-top: 0;\n  margin-left: 0;\n}\n\n#chat-widget .bot-status .status-dot {\n  display: none !important;\n}\n\n#chat-widget .status-text {\n  font-size: 13px;\n  color: #222;\n  font-weight: 400;\n}\n\n#chat-widget .header-menu {\n  margin-left: 12px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  height: 100%;\n  position: relative;\n}\n\n#chat-widget .header-menu svg {\n  display: block;\n  fill: #fff;\n  transition: background 0.2s;\n  border-radius: 6px;\n  padding: 2px;\n}\n\n#header-menu-btn svg {\n  width: 26px !important;\n  height: 26px !important;\n}\n\n#chat-widget .header-menu:focus svg,\n#chat-widget .header-menu:hover svg {\n  background: rgba(255, 255, 255, 0.12);\n}\n\n#chat-widget .header-dropdown {\n  position: absolute;\n  top: 48px;\n  right: 20px;\n  background: #fff;\n  color: #222;\n  border-radius: 8px;\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.13);\n  min-width: 120px;\n  z-index: 10;\n  font-size: 15px;\n  border: 1px solid #e1e8ed;\n  animation: fadeInMenu 0.18s;\n}\n\n@keyframes fadeInMenu {\n  from {\n    opacity: 0;\n    transform: translateY(-8px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n#chat-widget .dropdown-item {\n  padding: 12px 18px;\n  cursor: pointer;\n  border-radius: 8px;\n  transition: background 0.15s;\n}\n\n#chat-widget .dropdown-item:hover {\n  background: #f3f4f6;\n}\n\n#chat-close {\n  background: none;\n  border: none;\n  color: white;\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 4px;\n  opacity: 0.8;\n  transition: opacity 0.2s;\n}\n\n#chat-close:hover {\n  opacity: 1;\n}\n\n#chat-close:active {\n  transform: scale(0.95);\n}\n\n/* Messages container */\n#chat-messages {\n  flex: 1;\n  padding: 16px;\n  overflow-y: auto;\n  background: #f8fafd;\n}\n\n#chat-messages::-webkit-scrollbar {\n  width: 6px;\n}\n\n#chat-messages::-webkit-scrollbar-track {\n  background: #f1f1f1;\n  border-radius: 3px;\n}\n\n#chat-messages::-webkit-scrollbar-thumb {\n  background: #c1c1c1;\n  border-radius: 3px;\n}\n\n#chat-messages::-webkit-scrollbar-thumb:hover {\n  background: #a8a8a8;\n}\n\n/* Timestamp */\n.timestamp {\n  text-align: center;\n  margin-bottom: 16px;\n}\n\n.timestamp span {\n  font-size: 12px;\n  color: #999;\n  background: white;\n  padding: 4px 12px;\n  border-radius: 12px;\n  display: inline-block;\n}\n\n/* System message */\n.system-message {\n  text-align: center;\n  margin-bottom: 16px;\n}\n\n.system-message span {\n  font-size: 12px;\n  color: #999;\n}\n\n/* Message bubbles */\n.message {\n  display: flex;\n  margin-bottom: 14px;\n  gap: 0;\n}\n\n.message .content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n}\n\n.message.user {\n  justify-content: flex-end;\n}\n\n.message.user .content {\n  align-items: flex-end;\n}\n\n.sender-label {\n  font-size: 12px;\n  color: #888;\n  margin-bottom: 4px;\n  font-weight: 500;\n}\n\n.message .bubble {\n  background: #fff !important;\n  border: 1px solid #d1e7ff !important;\n  color: #222 !important;\n  padding: 12px 16px 14px 16px;\n  border-radius: 18px 18px 18px 4px;\n  font-size: 14px;\n  line-height: 1.5;\n  max-width: 85%;\n  min-width: 120px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);\n  word-break: break-word;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n}\n\n.message.user .bubble {\n  background: #e6f4ff !important;\n  border: 1px solid #90caf9 !important;\n  color: #222 !important;\n  border-radius: 18px 18px 4px 18px;\n  box-shadow: 0 2px 8px rgba(144, 202, 249, 0.15);\n}\n\n.message.user .bubble .bubble-time {\n  color: #888;\n}\n\n.message.user .bubble .bubble-content {\n  color: #222;\n}\n\n.bubble-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 4px;\n  font-size: 12px;\n}\n\n.bubble-time {\n  font-size: 12px;\n  color: #999;\n  margin-left: 10px;\n}\n\n.bubble-content {\n  font-size: 14px;\n  color: #333;\n  margin-top: 0;\n}\n\n/* Hilangkan avatar */\n.message .avatar {\n  display: none !important;\n}\n\n/* Loading indicator */\n#loading-indicator {\n  display: flex;\n  align-items: flex-start;\n  margin-bottom: 8px;\n  margin-left: 0;\n}\n#loading-indicator .bubble {\n  background: #fff !important;\n  border: 1px solid #d1e7ff !important;\n  color: #222 !important;\n  border-radius: 18px 18px 18px 4px !important;\n  box-shadow: none !important;\n  padding: 8px 14px !important;\n  min-width: 36px;\n  max-width: 60px;\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n}\n\n#loading-indicator .dots {\n  display: flex;\n  gap: 6px;\n  align-items: center;\n}\n\n#loading-indicator .dot {\n  width: 8px;\n  height: 8px;\n  background: #b0b8c1;\n  border-radius: 50%;\n  animation: loading-bounce 1.2s infinite both;\n  opacity: 0.7;\n}\n\n#loading-indicator .dot:nth-child(2) {\n  animation-delay: 0.2s;\n}\n#loading-indicator .dot:nth-child(3) {\n  animation-delay: 0.4s;\n}\n\n@keyframes loading-bounce {\n  0%,\n  80%,\n  100% {\n    transform: scale(0.8);\n    opacity: 0.5;\n  }\n  40% {\n    transform: scale(1.2);\n    opacity: 1;\n  }\n}\n/* Input area */\n.input-area {\n  padding: 16px;\n  border-top: 1px solid #e9ecef;\n  background: white;\n}\n\n.input-container {\n  display: flex;\n  gap: 4px;\n  align-items: center;\n  background: #f8fafd;\n  border-radius: 18px;\n  padding: 4px 10px;\n  border: 1px solid #e1e8ed;\n}\n\n#chat-input {\n  flex: 1;\n  border: none;\n  background: none;\n  padding: 6px 0;\n  font-size: 13px;\n  outline: none;\n  font-family: inherit;\n  color: #333;\n}\n\n#chat-input:focus {\n  border-color: transparent !important;\n  box-shadow: none !important;\n}\n\n#chat-send {\n  width: 32px;\n  height: 32px;\n  background: #19c6c2;\n  border: none;\n  border-radius: 50%;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n  flex-shrink: 0;\n}\n\n#chat-send:hover {\n  transform: scale(1.05);\n}\n\n#chat-send:active {\n  transform: scale(0.95);\n}\n\n#chat-send:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  transform: none !important;\n}\n\n.bubble-initial {\n  font-size: 13px;\n  color: #888;\n  font-weight: 500;\n  margin-bottom: 6px;\n  text-align: left;\n}\n\n#chat-widget #chat-button svg {\n  width: 48px !important;\n  height: 48px !important;\n  display: block;\n}\n\n#chat-widget #chat-button {\n  width: 60px !important;\n  height: 60px !important;\n}\n\n#header-menu svg {\n  width: 24px !important;\n  height: 24px !important;\n}\n\n#chat-widget .avatar-card {\n  background: #fff;\n  border-radius: 50%;\n  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.07);\n  padding: 2px;\n  width: 36px;\n  height: 36px;\n  margin-right: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n}\n\n#chat-widget .avatar-card img {\n  width: 32px;\n  height: 32px;\n  border-radius: 50%;\n  object-fit: cover;\n  background: #f4f6f8;\n}\n\n#chat-widget .avatar-card .status-dot {\n  position: absolute;\n  right: 0px;\n  bottom: 0px;\n  width: 8px;\n  height: 8px;\n  background: #22c55e;\n  border-radius: 50%;\n  border: 1px solid #fff;\n  box-shadow: 0 0 0 2px #19c6c2;\n  display: block;\n  margin: 0;\n}\n\n#chat-send svg {\n  width: 16px;\n  height: 16px;\n  fill: white;\n}\n\n/* Markdown formatting styles */\n.markdown-paragraph {\n  margin: 1px 0 1px 0;\n  font-size: 12px;\n  line-height: 1.3;\n  white-space: pre-wrap;\n  color: #222;\n}\n\n.markdown-heading {\n  font-weight: 700;\n  margin-bottom: 1px;\n  margin-top: 2px;\n  line-height: 1.2;\n  color: #1a1a1a;\n}\n\n.markdown-heading:first-child {\n  margin-top: 0;\n}\n\nh1.markdown-heading {\n  font-size: 13px;\n}\nh2.markdown-heading {\n  font-size: 12.5px;\n}\nh3.markdown-heading {\n  font-size: 12px;\n}\n\n.markdown-list {\n  padding-left: 16px;\n  margin-bottom: 2px;\n}\n\n.markdown-list ul,\n.markdown-list ol {\n  padding-left: 10px;\n  margin-bottom: 1px;\n}\n\n.markdown-list-item {\n  display: list-item;\n  margin-bottom: 1px;\n  font-size: 12px;\n  line-height: 1.4;\n  padding-left: 0;\n}\n\nul.markdown-list {\n  list-style-type: disc;\n  list-style-position: outside;\n}\n\nol.markdown-list {\n  list-style-type: decimal;\n  list-style-position: outside;\n}\n\n.markdown-hr {\n  margin: 2px 0;\n  border: none;\n  border-top: 1px solid #e5e7eb;\n}\n\n.inline-code {\n  font-family: monospace;\n  background-color: #f5f5f5;\n  padding: 0.05em 0.15em;\n  border-radius: 2px;\n  font-size: 11px;\n  color: #c7254e;\n}\n\n.code-block {\n  background-color: #f7f7f7;\n  padding: 6px;\n  border-radius: 3px;\n  overflow-x: auto;\n  margin-bottom: 4px;\n  margin-top: 4px;\n}\n\n.code-block code {\n  background-color: transparent;\n  padding: 0;\n  font-family: monospace;\n  font-size: 11px;\n  line-height: 1.3;\n  white-space: pre-wrap;\n  color: #333;\n}\n\nstrong {\n  font-weight: 700;\n  color: #1a1a1a;\n}\n\nem {\n  font-style: italic;\n  color: #444;\n}\n\n/* .bubble-content,\n.markdown-paragraph,\n.markdown-list-item,\n.code-block code {\n  line-height: 1.2 !important;\n} */\n\n.bubble-content br {\n  line-height: 1.5 !important;\n  display: block;\n  margin: 4px 0;\n  padding: 0;\n  height: 0;\n}\n\n/* Template Questions Styles */\n.template-questions {\n  padding: 12px 14px;\n  border-top: 1px solid #e9ecef;\n  background: #f8fafd;\n  max-height: 120px;\n  overflow-y: auto;\n  position: relative;\n}\n\n.template-questions-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 2px;\n  padding: 4px 10px;\n  background: #fff;\n  border-radius: 12px;\n  border: 1px solid #e1e8ed;\n  transition: all 0.2s ease;\n  cursor: pointer;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\n}\n\n.template-questions-header:hover {\n  background: #f8f9fa;\n  border-color: #19c6c2;\n  box-shadow: 0 2px 8px rgba(25, 198, 194, 0.1);\n  transform: translateY(-1px);\n}\n\n.template-questions-header.collapsed {\n  border-color: #d1d5db;\n  margin-bottom: 0px;\n  background: #f8f9fa;\n}\n\n.template-questions-header.collapsed:hover {\n  background: #f1f3f4;\n  border-color: #19c6c2;\n}\n\n.template-questions-title {\n  font-size: 13px;\n  font-weight: 600;\n  color: #374151;\n  letter-spacing: 0.3px;\n  transition: color 0.2s ease;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.template-questions-title::before {\n  content: 'ðŸ’¬';\n  font-size: 16px;\n}\n\n.template-questions-header:hover .template-questions-title {\n  color: #19c6c2;\n}\n\n.template-questions-header.collapsed .template-questions-title {\n  color: #6b7280;\n}\n\n.template-questions-toggle {\n  background: none;\n  border: none;\n  cursor: pointer;\n  padding: 6px;\n  border-radius: 6px;\n  color: #6b7280;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 28px;\n  height: 28px;\n}\n\n.template-questions-toggle:hover {\n  color: #19c6c2;\n  transform: scale(1.05);\n}\n\n.template-questions-toggle.collapsed {\n  transform: rotate(-90deg) scale(1.05);\n  color: #9ca3af;\n}\n\n.template-questions-toggle.collapsed:hover {\n  color: #19c6c2;\n}\n\n.template-questions-toggle svg {\n  transition: transform 0.2s ease;\n  width: 16px;\n  height: 16px;\n}\n\n.template-questions-content {\n  transition: all 0.3s ease;\n  overflow: hidden;\n  padding: 0;\n}\n\n.template-questions-content.collapsed {\n  max-height: 0;\n  opacity: 0;\n  padding: 0;\n}\n\n.template-questions-list {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  padding-top: 4px;\n}\n\n.template-question-item {\n  padding: 10px 14px;\n  background: #fff;\n  border: 1px solid #d1e7ff;\n  border-radius: 16px 16px 16px 4px;\n  font-size: 13px;\n  color: #222;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  line-height: 1.4;\n  word-wrap: break-word;\n  max-width: 100%;\n  position: relative;\n  overflow: hidden;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\n}\n\n.template-question-item::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 3px;\n  height: 100%;\n  background: #19c6c2;\n  opacity: 0;\n  transition: opacity 0.2s ease;\n}\n\n.template-question-item:hover {\n  background: #f8f9fa;\n  border-color: #19c6c2;\n  transform: translateY(-1px);\n  box-shadow: 0 3px 10px rgba(25, 198, 194, 0.15);\n}\n\n.template-question-item:hover::before {\n  opacity: 1;\n}\n\n.template-question-item:active {\n  transform: translateY(0) scale(0.98);\n  box-shadow: 0 2px 6px rgba(25, 198, 194, 0.1);\n}\n\n/* Scrollbar for template questions */\n.template-questions::-webkit-scrollbar {\n  width: 4px;\n}\n\n.template-questions::-webkit-scrollbar-track {\n  background: transparent;\n}\n\n.template-questions::-webkit-scrollbar-thumb {\n  background: #c1c1c1;\n  border-radius: 2px;\n}\n\n.template-questions::-webkit-scrollbar-thumb:hover {\n  background: #a8a8a8;\n}\n\n/* Animation for template questions appearance */\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(-5px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n.template-questions {\n  animation: fadeIn 0.3s ease-out;\n}\n\n/* Staggered animation for template question items */\n@keyframes slideInFromLeft {\n  from {\n    opacity: 0;\n    transform: translateX(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateX(0);\n  }\n}\n\n.template-question-item {\n  animation: slideInFromLeft 0.3s ease-out forwards;\n  opacity: 0;\n}\n\n/* Smooth transition for click feedback */\n.template-question-item {\n  transition: all 0.2s ease, background 0.15s ease;\n}\n\n/* Focus states for accessibility */\n.template-questions-toggle:focus {\n  outline: 2px solid #19c6c2;\n  outline-offset: 2px;\n}\n\n.template-question-item:focus {\n  outline: 2px solid #19c6c2;\n  outline-offset: 2px;\n}\n\n/* Loading state for template questions */\n.template-questions.loading {\n  opacity: 0.7;\n  pointer-events: none;\n}\n\n.template-questions.loading::after {\n  content: '';\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 20px;\n  height: 20px;\n  margin: -10px 0 0 -10px;\n  border: 2px solid #f3f3f3;\n  border-top: 2px solid #19c6c2;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n"),
    document.head.appendChild(n);
})(),
  (() => {
    let n = !1,
      e = !1,
      t = !0;
    let a = {
      useragent_name: 'Altius People',
      bot_name: 'Altius Assistant',
      bot_logo_url:
        'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkU3OUJGRDU3NEI1MTExRjA5RUMzOUMyNkNDRjkyRTg0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkU3OUJGRDU4NEI1MTExRjA5RUMzOUMyNkNDRjkyRTg0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RTc5QkZENTU0QjUxMTFGMDlFQzM5QzI2Q0NGOTJFODQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RTc5QkZENTY0QjUxMTFGMDlFQzM5QzI2Q0NGOTJFODQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4eA3aDAAAC80lEQVR42syYX4gNURzH5969yvpzlV3h5i7lxSJ3pVYiYhUR8i+51nq5m+wKJTx4ULIvlAehZCT/pkQibZKQF0rywAMpyp9CHrRErjbX5+Tc9prMzJmZM2ZOfc+ZO3fumc/5/c75nd+5RqVSMUIVy2xHYw3NRXAJpTX0tQmtNyIq6ZDWy1EvQBuTCWgYRdlHC7BTkgjY7nCtraTEREylUkHcO5X6ac2dd2i8USz90rVIwlrQPu/GobnJcLFlpuX8c3N5rHNwnrSYvawFfnASAJ3CShYtjxfQMuupV7s8sSFuCy6TlnIqSxhEQ5yAXrtGBq2LB9AyG6kXaxiEcsn4fH4y6lWJswxmBEG7T1vETlqppluZOF6eXbp3CE2TVL6mFRqOjqOz4fZi55eLQedqXtxkAxDXIx1+fgHt/NLb87Hq2UwAgFG2l+VtELkA0eEF2gLYHddF4mH66n2dW1kZ9aCDwJUdVzFg+2i2uZg+inJLWu2lUj4I5Bo+H0WjIwb7gHYAdtFXPsgPLtM0o9MRgYlE9hia5AXnmVFjzTaaE2iiJrjHaDNgj7Rk1HR0m2YaOhwS7Kuc261+4JTPJFhSpPD3AsJdQtsBex9mh/OKgx0B+n6FugC7GempDuvVyxWXVezrJzqEDgD3Q1eO4GbBFT7g7kqrPf+fhyYV936Sz7W5wllmAbVqywdx7xiaRa75nmGcQrsB++yR5IqQdQVdCzKn0y4HH6fvnqDZgHUqwIl+bsipsorPw3QB/itl/4Z2oRmAPVA4HuyhPo8GyTtDPU6Dai7GvQWagu32VRFwAXurAFZHfUQsGod5fSasBWvnyRtxEAdspRLcwKArUvYynwHkAwNivTo5//plTGsG7LovnxRLZbSVqznomT3u+j3x2S24EIn8bDpgYoV+DxzAiqX7oh+0XwbxQLvTXzsJFpxA8xowvUe9P/++nkSz5J2ZDOChyk6i/dDkAim81S1T/HMAdicLcAA0L93eCWS/F+BvAQYAY/cSG57y',
      template_questions: [],
    };
    async function o() {
      if (!window.session_id || '' === window.session_id)
        try {
          const n = await fetch(
            'https://aionegml-dev-c3aqcqg7abhhb2ag.southeastasia-01.azurewebsites.net/create_session',
            {
              method: 'GET',
              headers: { 'qubisa-token-key': window.chat_api_key },
            }
          );
          if (!n.ok) throw new Error('Failed to create session');
          {
            const e = await n.json();
            window.session_id = e.session_id;
          }
        } catch (n) {
          throw (console.error('Error creating session:', n), n);
        }
    }
    async function i() {
      const n = window.chat_api_key;
      if (n)
        try {
          const e = await fetch(
            'https://aionegml-dev-c3aqcqg7abhhb2ag.southeastasia-01.azurewebsites.net/detail_useragent_chat',
            { method: 'GET', headers: { 'qubisa-token-key': n } }
          );
          if (!e.ok) throw new Error(`HTTP error! status: ${e.status}`);
          const t = await e.json();
          if (
            t.success &&
            t.data &&
            t.data.detail_collection &&
            t.data.detail_collection.length > 0
          ) {
            const n = t.data.detail_collection[0];
            let e = [];
            if (n.template_question)
              try {
                e = JSON.parse(n.template_question);
              } catch (n) {
                console.warn('Failed to parse template_question:', n), (e = []);
              }
            (a = {
              useragent_name: n.useragent_name || 'Altius People',
              bot_name: n.bot_name || 'Altius Assistant',
              bot_logo_url:
                n.bot_logo_url ||
                'https://ui-avatars.com/api/?name=AI&background=19c6c2&color=fff',
              template_questions: e,
            }),
              (function () {
                const n = document.getElementById('bot-logo'),
                  e = document.getElementById('bot-name');
                n && (n.src = a.bot_logo_url);
                e && (e.textContent = a.bot_name);
                window.userAgentData = a;
              })(),
              s(),
              p('Hai, ada yang bisa dibantu hari ini?', !1);
          } else p('Hai, ada yang bisa dibantu hari ini?', !1);
        } catch (n) {
          p('Hai, ada yang bisa dibantu hari ini?', !1),
            console.error('Error fetching user agent details:', n);
        }
      else
        console.warn(
          'No authentication token available for user agent details'
        );
    }
    function s() {
      const n = document.getElementById('template-questions'),
        e = document.getElementById('template-questions-list'),
        t = document.getElementById('template-questions-toggle'),
        o = document.getElementById('template-questions-content');
      n &&
        e &&
        t &&
        o &&
        (a.template_questions && a.template_questions.length > 0
          ? ((e.innerHTML = ''),
            a.template_questions.forEach(n => {
              const t = document.createElement('div');
              (t.className = 'template-question-item'),
                (t.textContent = n),
                t.addEventListener('click', () =>
                  (function (n) {
                    const e = document.getElementById('chat-input');
                    (e.value = n), e.focus();
                    const t = new Event('input', { bubbles: !0 });
                    e.dispatchEvent(t);
                  })(n)
                ),
                e.appendChild(t);
            }),
            (n.style.display = 'block'),
            d())
          : (n.style.display = 'none'));
    }
    function r() {
      (t = !t), d();
    }
    function d() {
      const n = document.getElementById('template-questions-content'),
        e = document.getElementById('template-questions-toggle');
      n &&
        e &&
        (t
          ? ((n.style.display = 'block'), e.classList.remove('collapsed'))
          : ((n.style.display = 'none'), e.classList.add('collapsed')));
    }
    function l() {
      const n = `\n    <div id="chat-widget">\n      <div id="chat-window">\n        <div class="header">\n          <div class="avatar avatar-card">\n            <img id="bot-logo" src="${a.bot_logo_url}" alt="Bot Logo" onerror="window.handleBotLogoError && window.handleBotLogoError(this)" />\n            <span class="status-dot" id="bot-status"></span>\n          </div>\n          <div class="title">\n            <div class="title-text" id="bot-name">${a.bot_name}</div>\n            <div class="bot-status">\n              <span class="status-text">Online</span>\n            </div>\n          </div>\n          <div class="header-menu" id="header-menu-btn" tabindex="0">\n            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">\n              <circle cx="12" cy="5" r="2" fill="#fff"/>\n              <circle cx="12" cy="12" r="2" fill="#fff"/>\n              <circle cx="12" cy="19" r="2" fill="#fff"/>\n            </svg>\n          </div>\n          <div class="header-dropdown" id="header-dropdown" style="display:none;">\n            <div class="dropdown-item" id="new-chat-btn">Chat Baru</div>\n          </div>\n        </div>\n        <div id="chat-messages"></div>\n        <div class="template-questions" id="template-questions" style="display: none;">\n          <div class="template-questions-header">\n            <div class="template-questions-title" >Pertanyaan Sering Diajukan:</div>\n            <button class="template-questions-toggle" id="template-questions-toggle" title="Sembunyikan/Tampilkan pertanyaan">\n              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                <polyline points="6,9 12,15 18,9"></polyline>\n              </svg>\n            </button>\n          </div>\n          <div class="template-questions-content" id="template-questions-content">\n            <div class="template-questions-list" id="template-questions-list"></div>\n          </div>\n        </div>\n        <div class="input-area">\n          <div class="input-container">\n            <input id="chat-input" type="text" placeholder="Type here..." />\n            <button id="chat-send" disabled>\n              <svg width="16" height="16" viewBox="0 0 24 24" fill="white">\n                <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>\n              </svg>\n            </button>\n          </div>\n        </div>\n      </div>\n      <div id="chat-button">\n        <span id="icon-chat" style="display: block;">\n          <svg width="48" height="48" viewBox="0 0 48 48" fill="none">\n            <circle cx="24" cy="24" r="24" fill="#F44336"/>\n            <path d="M34 16a2 2 0 0 0-2-2H16a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10l4 4v-4h2a2 2 0 0 0 2-2V16z" fill="white"/>\n            <rect x="18" y="20" width="12" height="2" rx="1" fill="#F44336"/>\n            <rect x="18" y="24" width="8" height="2" rx="1" fill="#F44336"/>\n          </svg>\n        </span>\n        <span id="icon-close" style="display: none;">\n          <svg width="48" height="48" viewBox="0 0 48 48" fill="none">\n            <circle cx="24" cy="24" r="24" fill="#F44336"/>\n            <path d="M16 16L32 32M32 16L16 32" stroke="white" stroke-width="3" stroke-linecap="round"/>\n          </svg>\n        </span>\n      </div>\n    </div>\n  `;
      document.body.insertAdjacentHTML('beforeend', n),
        (function () {
          const n = document.getElementById('header-menu-btn'),
            e = document.getElementById('header-dropdown');
          if (!n || !e) return;
          n.addEventListener('click', n => {
            n.stopPropagation(),
              (e.style.display =
                'block' === e.style.display ? 'none' : 'block');
          }),
            document.addEventListener('click', () => {
              'block' === e.style.display && (e.style.display = 'none');
            }),
            e.addEventListener('click', n => {
              n.stopPropagation();
            }),
            document
              .getElementById('new-chat-btn')
              .addEventListener('click', () => {
                !(function () {
                  const n = document.getElementById('chat-messages');
                  n && (n.innerHTML = '');
                  (window.session_id = ''),
                    o().then(() => {
                      i(), s();
                    });
                })(),
                  (e.style.display = 'none');
              });
        })();
    }
    function c(n) {
      return n
        ? n
            .replace(/\\n/g, '\n')
            .replace(/\\t/g, '\t')
            .replace(/\\r/g, '\r')
            .replace(/\\f/g, '\f')
            .replace(/\\b/g, '\b')
            .replace(/\\'/g, "'")
            .replace(/\\"/g, '"')
            .replace(/\\\\/g, '\\')
        : '';
    }
    function p(n, e = !1) {
      const t = document.getElementById('chat-messages'),
        o = `<div class="bubble-header"><span class="sender-label">${
          e ? 'You' : a.bot_name
        }</span><span class="bubble-time">${new Date().toLocaleTimeString(
          'id-ID',
          { hour: '2-digit', minute: '2-digit' }
        )}</span></div>`,
        i = c(n);
      let s = i;
      s = e
        ? i.replace(/\n/g, '<br>')
        : (function (n) {
            if (!n || !n.trim())
              return '<span style="font-style: italic; color: #9ca3af;">[Pesan kosong]</span>';
            let e = c(n);
            return (
              (e = e.replace(
                /```([a-zA-Z]*)\n([\s\S]*?)```/g,
                (n, e, t) =>
                  `<pre class="code-block"><code>${t.replace(
                    /\n/g,
                    '<br>'
                  )}</code></pre>`
              )),
              (e = e.replace(
                /`([^`]+)`/g,
                '<code class="inline-code">$1</code>'
              )),
              (e = e.replace(
                /^### (.*)$/gm,
                '<h3 class="markdown-heading">$1</h3>'
              )),
              (e = e.replace(
                /^## (.*)$/gm,
                '<h2 class="markdown-heading">$1</h2>'
              )),
              (e = e.replace(
                /^# (.*)$/gm,
                '<h1 class="markdown-heading">$1</h1>'
              )),
              (e = e.replace(/^---$/gm, '<hr class="markdown-hr">')),
              (e = e.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')),
              (e = e.replace(/\*(.*?)\*/g, '<em>$1</em>')),
              (e = e.replace(
                /(?:^|\n)- (.*?)(?=\n|$)/g,
                '<li class="markdown-list-item">$1</li>'
              )),
              (e = e.replace(
                /(<li class="markdown-list-item">[\s\S]*?<\/li>)/g,
                '<ul class="markdown-list">$1</ul>'
              )),
              (e = e.replace(
                /(?:^|\n)[0-9]+\. (.*?)(?=\n|$)/g,
                '<li class="markdown-list-item">$1</li>'
              )),
              (e = e.replace(
                /(<li class="markdown-list-item">[\s\S]*?<\/li>)/g,
                '<ol class="markdown-list">$1</ol>'
              )),
              (e = e.replace(
                /^(?!<[hou][1-6l]|<pre|<hr|<ul|<ol)(.+)$/gm,
                '<p class="markdown-paragraph">$1</p>'
              )),
              (e = e.replace(/<p class="markdown-paragraph"><\/p>/g, '')),
              (e = e.replace(/\n/g, '<br>')),
              e
            );
          })(i);
      const r = `\n    <div class="message${
        e ? ' user' : ''
      }">\n      <div class="bubble">\n        ${o}\n        ${`<div class="bubble-content">${s}</div>`}\n      </div>\n    </div>\n  `;
      t.insertAdjacentHTML('beforeend', r), (t.scrollTop = t.scrollHeight);
    }
    function m() {
      const n = document.getElementById('loading-indicator');
      n && n.remove();
    }
    async function g() {
      const n = document.getElementById('chat-input'),
        t = document.getElementById('chat-send'),
        a = n.value.trim();
      if (a && !e) {
        p(a, !0),
          (n.value = ''),
          (e = !0),
          (t.disabled = !0),
          (function () {
            const n = document.getElementById('chat-messages');
            n.insertAdjacentHTML(
              'beforeend',
              '\n    <div id="loading-indicator">\n      <div class="content">\n        <div class="bubble">\n          <div class="dots">\n            <div class="dot"></div>\n            <div class="dot"></div>\n            <div class="dot"></div>\n          </div>\n        </div>\n      </div>\n    </div>\n  '
            ),
              (n.scrollTop = n.scrollHeight);
          })();
        try {
          const n = await (async function (n) {
            await o();
            try {
              const e = await fetch(
                'https://aionegml-dev-c3aqcqg7abhhb2ag.southeastasia-01.azurewebsites.net/chat',
                {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json',
                    'qubisa-token-key': window.chat_api_key,
                  },
                  body: JSON.stringify({
                    session_id: window.session_id,
                    prompt: n,
                    user_profile: window.personal_data,
                  }),
                }
              );
              if (e.ok) return (await e.json()).response;
              throw new Error('Failed to send message');
            } catch (n) {
              return (
                console.error('Error sending message:', n),
                'Maaf, terjadi kesalahan. Silakan coba lagi.'
              );
            }
          })(a);
          m(), p(n);
        } catch (n) {
          m(), p('Maaf, terjadi kesalahan. Silakan coba lagi.');
        } finally {
          (e = !1), (t.disabled = !1);
        }
      }
    }
    function u() {
      const e = document.getElementById('chat-window'),
        t = document.getElementById('icon-chat'),
        a = document.getElementById('icon-close');
      (n = !n),
        (e.style.display = n ? 'flex' : 'none'),
        (t.style.display = n ? 'none' : 'block'),
        (a.style.display = n ? 'block' : 'none'),
        n &&
          setTimeout(() => {
            document.getElementById('chat-input').focus();
          }, 100);
    }
    function h() {
      if (!window.chat_api_key)
        return void console.error(
          'Altius Chat Widget: chat_api_key is required'
        );
      if (!window.personal_data)
        return void console.error(
          'Altius Chat Widget: personal_data is required'
        );
      l(),
        o().then(() => {
          i();
        }),
        document.getElementById('chat-button').addEventListener('click', u),
        document.getElementById('chat-send').addEventListener('click', g);
      const n = document.getElementById('template-questions-toggle');
      n && n.addEventListener('click', r);
      const t = document.getElementById('chat-input'),
        a = document.getElementById('chat-send');
      t.addEventListener('input', function () {
        a.disabled = !this.value.trim() || e;
      }),
        t.addEventListener('keypress', n => {
          'Enter' !== n.key || n.shiftKey || (n.preventDefault(), g());
        });
    }
    (window.userAgentData = a),
      'loading' === document.readyState
        ? document.addEventListener('DOMContentLoaded', h)
        : h(),
      (window.handleBotLogoError = function (n) {
        const e = (
          (window.userAgentData && window.userAgentData.bot_name) ||
          'AI'
        )
          .split(' ')
          .map(n => n[0])
          .join('')
          .toUpperCase()
          .slice(0, 2);
        (n.onerror = null),
          (n.src = `https://ui-avatars.com/api/?name=${e}&background=19c6c2&color=fff`);
      });
  })();
